{"version":3,"file":"days.js","sources":["../../../src/components/power-calendar-multiple/days.gts"],"sourcesContent":["import Component from '@glimmer/component';\nimport { tracked } from '@glimmer/tracking';\nimport { action } from '@ember/object';\nimport { scheduleOnce } from '@ember/runloop';\nimport service from '../../-private/service.ts';\nimport {\n  add,\n  formatDate,\n  getWeekdays,\n  getWeekdaysMin,\n  getWeekdaysShort,\n  isBefore,\n  isSame,\n  normalizeDate,\n  withLocale,\n  type PowerCalendarDay,\n  type TWeekdayFormat,\n} from '../../utils.ts';\nimport type { PowerCalendarMultipleAPI } from '../power-calendar-multiple.ts';\nimport {\n  buildDay,\n  dayIsDisabled,\n  firstDay,\n  lastDay,\n  localeStartOfWeekOrFallback,\n  weekdaysNames,\n  weeks,\n  handleDayKeyDown,\n  focusDate,\n  handleClick,\n  type Week,\n} from '../../-private/days-utils.ts';\nimport { modifier } from 'ember-modifier';\nimport { or } from 'ember-truth-helpers';\nimport { on } from '@ember/modifier';\nimport emberPowerCalendarDayClasses, {\n  type TDayClass,\n} from '../../helpers/ember-power-calendar-day-classes.ts';\nimport type PowerCalendarService from '../../services/power-calendar.ts';\nimport type { PowerCalendarDaysArgs } from '../power-calendar/days.ts';\n\ninterface PowerCalendarMultipleDaysArgs extends Omit<\n  PowerCalendarDaysArgs,\n  'calendar' | 'dayClass' | 'selected'\n> {\n  calendar: PowerCalendarMultipleAPI;\n  dayClass?: TDayClass<PowerCalendarMultipleAPI>;\n  selected?: Date[];\n  maxLength?: number;\n}\n\nexport interface PowerCalendarMultipleDaysSignature {\n  Element: HTMLElement;\n  Args: PowerCalendarMultipleDaysArgs;\n  Blocks: {\n    default: [\n      day: PowerCalendarDay,\n      calendar: PowerCalendarMultipleAPI,\n      weeks: Week[],\n    ];\n  };\n}\n\nexport default class PowerCalendarMultipleDays extends Component<PowerCalendarMultipleDaysSignature> {\n  @service declare powerCalendar: PowerCalendarService;\n\n  @tracked focusedId: string | null = null;\n\n  didSetup = false;\n\n  get weekdayFormat(): TWeekdayFormat {\n    return this.args.weekdayFormat || 'short'; // \"min\" | \"short\" | \"long\"\n  }\n\n  get showDaysAround(): boolean {\n    return this.args.showDaysAround !== undefined\n      ? this.args.showDaysAround\n      : true;\n  }\n\n  get weekdaysMin(): string[] {\n    return withLocale(this.args.calendar.locale, getWeekdaysMin) as string[];\n  }\n\n  get weekdaysShort(): string[] {\n    return withLocale(this.args.calendar.locale, getWeekdaysShort) as string[];\n  }\n\n  get weekdays(): string[] {\n    return withLocale(this.args.calendar.locale, getWeekdays) as string[];\n  }\n\n  get localeStartOfWeek(): number {\n    return localeStartOfWeekOrFallback(\n      this.args.startOfWeek,\n      this.args.calendar.locale,\n    );\n  }\n\n  get weekdaysNames(): string[] {\n    return weekdaysNames(\n      this.localeStartOfWeek,\n      this.weekdayFormat,\n      this.weekdays,\n      this.weekdaysMin,\n      this.weekdaysShort,\n    );\n  }\n\n  get days(): PowerCalendarDay[] {\n    const today = this.powerCalendar.getDate();\n    const theLastDay = lastDay(this.localeStartOfWeek, this.currentCenter);\n    let day = firstDay(this.currentCenter, this.localeStartOfWeek);\n    const days: PowerCalendarDay[] = [];\n    while (isBefore(day, theLastDay)) {\n      days.push(\n        buildDay(\n          day,\n          today,\n          this.args.calendar,\n          this.focusedId,\n          this.currentCenter,\n          this.dayIsSelected.bind(this),\n          this.args.minDate,\n          this.args.maxDate,\n          this.args.disabledDates,\n          this.dayIsDisabled.bind(this),\n        ),\n      );\n      day = add(day, 1, 'day');\n    }\n    return days;\n  }\n\n  get weeks(): Week[] {\n    return weeks(this.days, this.showDaysAround);\n  }\n\n  get currentCenter(): Date {\n    let center = this.args.center;\n    if (!center) {\n      center = this.args.selected\n        ? this.args.selected[0]\n        : this.args.calendar.center;\n    }\n    return normalizeDate(center) || this.args.calendar.center;\n  }\n\n  get maxLength(): number {\n    return this.args.maxLength || Infinity;\n  }\n\n  // Actions\n  @action\n  handleDayFocus(e: FocusEvent): void {\n    scheduleOnce(\n      'actions',\n      this,\n      this._updateFocused.bind(this),\n      (e.target as HTMLElement).dataset['date'],\n    );\n  }\n\n  @action\n  handleDayBlur(): void {\n    scheduleOnce('actions', this, this._updateFocused.bind(this), null);\n  }\n\n  @action\n  async handleKeyDown(e: KeyboardEvent): Promise<void> {\n    const day = handleDayKeyDown(e, this.focusedId, this.days);\n\n    if (!day || !day?.isCurrentMonth) {\n      if (this.args.calendar.actions.moveCenter) {\n        if (\n          e.key === 'ArrowUp' ||\n          e.key === 'ArrowRight' ||\n          e.key === 'ArrowDown' ||\n          e.key === 'ArrowLeft'\n        ) {\n          const currentDay = this.days.find(\n            (x) => x.id === this.focusedId,\n          )?.date;\n\n          if (currentDay) {\n            let date = currentDay;\n            let step = 1;\n            if (e.key === 'ArrowUp') {\n              date = add(currentDay, -7, 'day');\n              step = -1;\n            } else if (e.key === 'ArrowLeft') {\n              date = add(currentDay, -1, 'day');\n              step = -1;\n            } else if (e.key === 'ArrowRight') {\n              date = add(currentDay, 1, 'day');\n            } else if (e.key === 'ArrowDown') {\n              date = add(currentDay, 7, 'day');\n            }\n\n            await this.focusDay(e, date, step);\n\n            return;\n          }\n        }\n      }\n    }\n\n    if (!day) {\n      return;\n    }\n\n    this.focusedId = day.id;\n    scheduleOnce(\n      'afterRender',\n      this,\n      focusDate,\n      this.args.calendar.uniqueId,\n      this.focusedId ?? '',\n    );\n  }\n\n  @action\n  handleClick(e: MouseEvent) {\n    handleClick(e, this.days, this.args.calendar);\n  }\n\n  setup = modifier(\n    () => {\n      if (this.didSetup) {\n        return;\n      }\n\n      this.didSetup = true;\n\n      if (this.args.autofocus) {\n        scheduleOnce('afterRender', this, this.initialFocus.bind(this));\n      }\n    },\n    // eslint-disable-next-line @typescript-eslint/ban-ts-comment\n    // @ts-ignore\n    { eager: false },\n  );\n\n  initialFocus() {\n    const activeDay = this.days.find((x) => x.isSelected && !x.isDisabled);\n\n    if (activeDay) {\n      this.focusedId = activeDay.id;\n    } else {\n      const todayDay = this.days.find((x) => x.isToday && !x.isDisabled);\n      if (todayDay) {\n        this.focusedId = todayDay.id ?? '';\n      } else {\n        const firstSelectableDay = this.days.find((x) => !x.isDisabled);\n        if (firstSelectableDay) {\n          this.focusedId = firstSelectableDay.id ?? '';\n        } else {\n          this.focusedId = this.days.find((x) => !x.isCurrentMonth)?.id ?? '';\n        }\n      }\n    }\n\n    focusDate(this.args.calendar.uniqueId, this.focusedId ?? '');\n  }\n\n  async focusDay(e: MouseEvent | KeyboardEvent, date: Date, step: number = 0) {\n    if (\n      dayIsDisabled(\n        date,\n        this.args.calendar,\n        this.args.minDate,\n        this.args.maxDate,\n        this.args.disabledDates,\n      )\n    ) {\n      return;\n    }\n\n    if (this.args.calendar.actions.moveCenter && step !== 0) {\n      await this.args.calendar.actions.moveCenter(\n        step,\n        'month',\n        this.args.calendar,\n        e,\n      );\n    }\n\n    this.focusedId = formatDate(date, 'YYYY-MM-DD');\n\n    if (step !== 0) {\n      scheduleOnce(\n        'afterRender',\n        this,\n        focusDate,\n        this.args.calendar.uniqueId,\n        this.focusedId ?? '',\n      );\n    } else {\n      focusDate(this.args.calendar.uniqueId, this.focusedId ?? '');\n    }\n  }\n\n  // Methods\n  dayIsSelected(\n    date: Date,\n    calendar: PowerCalendarMultipleAPI = this.args.calendar,\n  ) {\n    const selected = calendar.selected || [];\n    return selected.some((d) => isSame(date, d, 'day'));\n  }\n\n  _updateFocused(id?: string | null) {\n    this.focusedId = id ?? null;\n  }\n\n  dayIsDisabled(\n    date: Date,\n    calendarApi: PowerCalendarMultipleAPI,\n    minDate?: Date,\n    maxDate?: Date,\n    disabledDates?: Array<Date | string>,\n  ) {\n    const calendar = calendarApi;\n    const numSelected = (calendar.selected && calendar.selected.length) || 0;\n    const maxLength = this.maxLength || Infinity;\n    return (\n      dayIsDisabled(date, calendar, minDate, maxDate, disabledDates) ||\n      (numSelected >= maxLength && !this.dayIsSelected(date))\n    );\n  }\n\n  <template>\n    {{! template-lint-disable no-invalid-interactive }}\n    <div\n      class=\"ember-power-calendar-days\"\n      data-power-calendar-id={{or\n        @calendar.calendarUniqueId\n        @calendar.uniqueId\n      }}\n      role=\"grid\"\n      aria-labelledby=\"ember-power-calendar-nav-title-{{@calendar.uniqueId}}\"\n      {{on \"click\" this.handleClick}}\n      {{this.setup}}\n      ...attributes\n    >\n      <div\n        class=\"ember-power-calendar-row ember-power-calendar-weekdays\"\n        role=\"row\"\n      >\n        {{#each this.weekdaysNames as |wdn|}}\n          <div\n            class=\"ember-power-calendar-weekday\"\n            role=\"columnheader\"\n          >{{wdn}}</div>\n        {{/each}}\n      </div>\n      <div\n        class=\"ember-power-calendar-day-grid\"\n        role=\"rowgroup\"\n        {{on \"keydown\" this.handleKeyDown}}\n      >\n        {{#each this.weeks key=\"id\" as |week|}}\n          <div\n            class=\"ember-power-calendar-row ember-power-calendar-week\"\n            role=\"row\"\n            data-missing-days={{week.missingDays}}\n          >\n            {{#each week.days key=\"id\" as |day|}}\n              <button\n                type=\"button\"\n                role=\"gridcell\"\n                data-date=\"{{day.id}}\"\n                class={{emberPowerCalendarDayClasses\n                  day\n                  @calendar\n                  this.weeks\n                  @dayClass\n                }}\n                {{on \"focus\" this.handleDayFocus}}\n                {{on \"blur\" this.handleDayBlur}}\n                disabled={{day.isDisabled}}\n                tabindex={{if day.isFocused \"0\" \"-1\"}}\n                aria-selected={{if day.isSelected \"true\"}}\n              >\n                {{#if (has-block)}}\n                  {{yield day @calendar this.weeks}}\n                {{else}}\n                  {{day.number}}\n                {{/if}}\n              </button>\n            {{/each}}\n          </div>\n        {{/each}}\n      </div>\n    </div>\n  </template>\n}\n"],"names":["PowerCalendarMultipleDays","Component","g","prototype","service","i","tracked","didSetup","weekdayFormat","args","showDaysAround","undefined","weekdaysMin","withLocale","calendar","locale","getWeekdaysMin","weekdaysShort","getWeekdaysShort","weekdays","getWeekdays","localeStartOfWeek","localeStartOfWeekOrFallback","startOfWeek","weekdaysNames","days","today","powerCalendar","getDate","theLastDay","lastDay","currentCenter","day","firstDay","isBefore","push","buildDay","focusedId","dayIsSelected","bind","minDate","maxDate","disabledDates","dayIsDisabled","add","weeks","center","selected","normalizeDate","maxLength","Infinity","handleDayFocus","e","scheduleOnce","_updateFocused","target","dataset","n","action","handleDayBlur","handleKeyDown","handleDayKeyDown","isCurrentMonth","actions","moveCenter","key","currentDay","find","x","id","date","step","focusDay","focusDate","uniqueId","handleClick","setup","modifier","autofocus","initialFocus","eager","activeDay","isSelected","isDisabled","todayDay","isToday","firstSelectableDay","formatDate","some","d","isSame","calendarApi","numSelected","length","setComponentTemplate","precompileTemplate","strictMode","scope","or","on","emberPowerCalendarDayClasses"],"mappings":"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"}