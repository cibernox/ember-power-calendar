{"version":3,"file":"power-calendar-multiple.js","sources":["../../src/components/power-calendar-multiple.gts"],"sourcesContent":["import Component from '@glimmer/component';\nimport { tracked } from '@glimmer/tracking';\nimport { guidFor } from '@ember/object/internals';\nimport service from '../-private/service.ts';\nimport { assert } from '@ember/debug';\nimport { isArray } from '@ember/array';\nimport { action } from '@ember/object';\nimport { task, type TaskInstance } from 'ember-concurrency';\nimport PowerCalendarMultipleDaysComponent, {\n  type PowerCalendarMultipleDaysSignature,\n} from './power-calendar-multiple/days.gts';\nimport PowerCalendarMultipleNavComponent, {\n  type PowerCalendarMultipleNavSignature,\n} from './power-calendar-multiple/nav.gts';\nimport {\n  normalizeDate,\n  isSame,\n  normalizeMultipleActionValue,\n  normalizeCalendarValue,\n  type NormalizeMultipleActionValue,\n  type PowerCalendarDay,\n  type NormalizeCalendarValue,\n  add,\n} from '../utils.ts';\nimport type {\n  // CalendarDay,\n  PowerCalendarAPI,\n  PowerCalendarArgs,\n  SelectedDays,\n  TPowerCalendarMoveCenterUnit,\n} from './power-calendar.ts';\nimport type Owner from '@ember/owner';\nimport type { ComponentLike } from '@glint/template';\nimport type PowerCalendarService from '../services/power-calendar.ts';\nimport { hash } from '@ember/helper';\nimport { element } from 'ember-element-helper';\n\nexport interface PowerCalendarMultipleActions {\n  changeCenter?: (\n    newCenter: Date,\n    calendar: PowerCalendarMultipleAPI,\n    event: MouseEvent,\n  ) => TaskInstance<void>;\n  moveCenter?: (\n    step: number,\n    unit: TPowerCalendarMoveCenterUnit,\n    calendar: PowerCalendarMultipleAPI,\n    event: MouseEvent | KeyboardEvent,\n  ) => Promise<void>;\n  select?: (\n    day: PowerCalendarDay | PowerCalendarDay[],\n    calendar: PowerCalendarMultipleAPI,\n    event: MouseEvent,\n  ) => void;\n}\n\nexport interface PowerCalendarMultipleAPI extends Omit<\n  PowerCalendarAPI,\n  'type' | 'selected' | 'actions'\n> {\n  type: 'multiple';\n  selected?: Date[];\n  actions: PowerCalendarMultipleActions;\n}\n\nexport type TPowerCalendarMultipleOnSelect = (\n  day: NormalizeMultipleActionValue,\n  calendar: PowerCalendarMultipleAPI,\n  event?: Event,\n) => void;\n\ninterface PowerCalendarMultipleArgs extends Omit<\n  PowerCalendarArgs,\n  | 'navComponent'\n  | 'daysComponent'\n  | 'selected'\n  | 'onSelect'\n  | 'onCenterChange'\n  | 'onInit'\n> {\n  navComponent?: ComponentLike<PowerCalendarMultipleNavSignature>;\n  daysComponent?: ComponentLike<PowerCalendarMultipleDaysSignature>;\n  selected?: Date[];\n  onSelect?: TPowerCalendarMultipleOnSelect;\n  onInit?: (calendar: PowerCalendarMultipleAPI) => void;\n  onCenterChange?: (\n    newCenter: NormalizeCalendarValue,\n    calendar: PowerCalendarMultipleAPI,\n    event: Event,\n  ) => Promise<void> | void;\n}\n\ninterface PowerCalendarMultipleDefaultBlock extends PowerCalendarMultipleAPI {\n  Nav: ComponentLike<{\n    Args: Omit<PowerCalendarMultipleNavSignature['Args'], 'calendar'>;\n    Blocks: PowerCalendarMultipleNavSignature['Blocks'];\n  }>;\n  Days: ComponentLike<{\n    Element: PowerCalendarMultipleDaysSignature['Element'];\n    Args: Omit<PowerCalendarMultipleDaysSignature['Args'], 'calendar'>;\n    Blocks: PowerCalendarMultipleDaysSignature['Blocks'];\n  }>;\n}\n\ninterface PowerCalendarMultipleSignature {\n  Element: HTMLElement;\n  Args: PowerCalendarMultipleArgs;\n  Blocks: {\n    default: [PowerCalendarMultipleDefaultBlock];\n  };\n}\n\nexport default class PowerCalendarMultiple extends Component<PowerCalendarMultipleSignature> {\n  @service declare powerCalendar: PowerCalendarService;\n\n  @tracked center = null;\n  @tracked _selected?: SelectedDays;\n\n  // Lifecycle hooks\n  constructor(owner: Owner, args: PowerCalendarMultipleArgs) {\n    super(owner, args);\n    this.registerCalendar();\n    if (this.args.onInit) {\n      this.args.onInit(this.publicAPI);\n    }\n  }\n\n  willDestroy(): void {\n    super.willDestroy();\n    this.unregisterCalendar();\n  }\n\n  get publicActions(): PowerCalendarMultipleActions {\n    const onSelect = this.args.onSelect;\n    const select = this.select.bind(this);\n    const onCenterChange = this.args.onCenterChange;\n    const changeCenterTask = this.changeCenterTask;\n    const currentCenter = this.currentCenter;\n\n    const actions: PowerCalendarMultipleActions = {};\n    if (onSelect) {\n      actions.select = (...args) => select(...args);\n    }\n    if (onCenterChange) {\n      const changeCenter = (\n        newCenter: Date,\n        calendar: PowerCalendarMultipleAPI,\n        e: Event,\n      ) => {\n        return changeCenterTask.perform(newCenter, calendar, e);\n      };\n      actions.changeCenter = changeCenter;\n      actions.moveCenter = async (step, unit, calendar, e) => {\n        const newCenter = add(currentCenter, step, unit);\n        return await changeCenter(newCenter, calendar, e);\n      };\n    }\n\n    return actions;\n  }\n\n  get selected(): Date[] | undefined {\n    if (this._selected) {\n      return (this._selected as Date[]) || undefined;\n    }\n\n    const value = this.args.selected;\n\n    if (!isArray(value)) {\n      return value;\n    }\n\n    const selected: Date[] = [];\n\n    for (const date of value) {\n      const normalizedDate = normalizeDate(date);\n      if (!(normalizedDate instanceof Date)) {\n        continue;\n      }\n      selected.push(normalizedDate);\n    }\n\n    return selected;\n  }\n\n  set selected(v: SelectedDays) {\n    this._selected = normalizeDate(v as Date | undefined);\n  }\n\n  get currentCenter(): Date {\n    let center = this.args.center;\n    if (!center) {\n      center = (this.selected || [])[0] || this.powerCalendar.getDate();\n    }\n    return normalizeDate(center) || this.powerCalendar.getDate();\n  }\n\n  get publicAPI(): PowerCalendarMultipleAPI {\n    return {\n      uniqueId: guidFor(this),\n      type: 'multiple',\n      selected: this.selected,\n      loading: this.changeCenterTask.isRunning,\n      center: this.currentCenter,\n      locale: this.args.locale || this.powerCalendar.locale,\n      actions: this.publicActions,\n    };\n  }\n\n  get tagWithDefault(): keyof HTMLElementTagNameMap {\n    if (this.args.tag === undefined || this.args.tag === null) {\n      return 'div';\n    }\n    return this.args.tag;\n  }\n\n  get navComponent(): ComponentLike<PowerCalendarMultipleNavSignature> {\n    return (\n      this.args.navComponent ||\n      (PowerCalendarMultipleNavComponent as ComponentLike<PowerCalendarMultipleNavSignature>)\n    );\n  }\n\n  get daysComponent(): ComponentLike<PowerCalendarMultipleDaysSignature> {\n    return (\n      this.args.daysComponent ||\n      (PowerCalendarMultipleDaysComponent as ComponentLike<PowerCalendarMultipleDaysSignature>)\n    );\n  }\n\n  calendarAPI(\n    publicAPI: PowerCalendarMultipleAPI,\n    components: {\n      Nav: ComponentLike<PowerCalendarMultipleNavSignature>;\n      Days: ComponentLike<PowerCalendarMultipleDaysSignature>;\n    },\n  ): PowerCalendarMultipleDefaultBlock {\n    return Object.assign(\n      {},\n      publicAPI,\n      components,\n    ) as PowerCalendarMultipleDefaultBlock;\n  }\n\n  // Tasks\n  changeCenterTask = task(\n    async (newCenter: Date, calendar: PowerCalendarMultipleAPI, e: Event) => {\n      assert(\n        \"You attempted to move the center of a calendar that doesn't receive an `@onCenterChange` action.\",\n        typeof this.args.onCenterChange === 'function',\n      );\n      const value = normalizeCalendarValue({ date: newCenter });\n      await this.args.onCenterChange(value, calendar, e);\n    },\n  );\n\n  // Actions\n  @action\n  select(\n    dayOrDays: PowerCalendarDay | PowerCalendarDay[],\n    calendar: PowerCalendarMultipleAPI,\n    e?: Event,\n  ) {\n    console.log('dayOrDays', dayOrDays);\n    assert(\n      `The select action expects an array of date objects, or a date object. ${typeof dayOrDays} was recieved instead.`,\n      isArray(dayOrDays) ||\n        (dayOrDays instanceof Object && dayOrDays.date instanceof Date),\n    );\n\n    let days;\n\n    if (isArray(dayOrDays)) {\n      days = dayOrDays;\n    } else if (dayOrDays instanceof Object && dayOrDays.date instanceof Date) {\n      days = [dayOrDays];\n    }\n\n    if (this.args.onSelect) {\n      this.args.onSelect(\n        this._buildCollection((days as PowerCalendarDay[]) ?? []),\n        calendar,\n        e,\n      );\n    }\n  }\n\n  // Methods\n  _buildCollection(days: PowerCalendarDay[]): NormalizeMultipleActionValue {\n    let selected = this.selected || [];\n\n    for (const day of days) {\n      const index = selected.findIndex((selectedDate) =>\n        isSame(day.date, selectedDate, 'day'),\n      );\n      if (index === -1) {\n        selected = [...selected, day.date];\n      } else {\n        selected = selected.slice(0, index).concat(selected.slice(index + 1));\n      }\n    }\n\n    return normalizeMultipleActionValue({ date: selected });\n  }\n\n  // Methods\n  registerCalendar() {\n    if (window) {\n      // @ts-expect-error Property '__powerCalendars'\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-assignment\n      window.__powerCalendars = window.__powerCalendars || {}; // TODO: weakmap??\n      // @ts-expect-error Property '__powerCalendars'\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n      window.__powerCalendars[this.publicAPI.uniqueId] = this;\n    }\n  }\n\n  unregisterCalendar() {\n    // @ts-expect-error Property '__powerCalendars'\n    // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n    if (window && window.__powerCalendars?.[guidFor(this)]) {\n      // @ts-expect-error Property '__powerCalendars'\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-member-access\n      delete window.__powerCalendars[guidFor(this)];\n\n      // @ts-expect-error Property '__powerCalendars'\n      // eslint-disable-next-line @typescript-eslint/no-unsafe-argument\n      if (Object.keys(window.__powerCalendars).length === 0) {\n        // @ts-expect-error Property '__powerCalendars'\n        delete window.__powerCalendars;\n      }\n    }\n  }\n\n  <template>\n    {{#let\n      (this.calendarAPI\n        this.publicAPI\n        (hash\n          Nav=(component\n            this.navComponent calendar=this.publicAPI isDatePicker=@isDatePicker\n          )\n          Days=(component\n            this.daysComponent\n            calendar=this.publicAPI\n            isDatePicker=@isDatePicker\n            autofocus=@autofocus\n          )\n        )\n      )\n      as |calendar|\n    }}\n      {{#let (element this.tagWithDefault) as |Tag|}}\n        <Tag\n          class=\"ember-power-calendar\"\n          role={{if @isDatePicker \"dialog\" \"group\"}}\n          aria-modal={{if @isDatePicker \"true\"}}\n          aria-label={{if\n            @ariaLabel\n            @ariaLabel\n            (unless @ariaLabeledBy \"Choose Multiple Dates\")\n          }}\n          aria-labelledby={{@ariaLabeledBy}}\n          ...attributes\n          id={{calendar.uniqueId}}\n        >\n          {{#if (has-block)}}\n            {{yield calendar}}\n          {{else}}\n            <calendar.Nav />\n            <calendar.Days />\n          {{/if}}\n        </Tag>\n      {{/let}}\n    {{/let}}\n  </template>\n}\n"],"names":["PowerCalendarMultiple","Component","g","prototype","service","i","tracked","constructor","owner","args","registerCalendar","onInit","publicAPI","willDestroy","unregisterCalendar","publicActions","onSelect","select","bind","onCenterChange","changeCenterTask","currentCenter","actions","changeCenter","newCenter","calendar","e","perform","moveCenter","step","unit","add","selected","_selected","undefined","value","isArray","date","normalizedDate","normalizeDate","Date","push","v","center","powerCalendar","getDate","uniqueId","guidFor","type","loading","isRunning","locale","tagWithDefault","tag","navComponent","PowerCalendarMultipleNavComponent","daysComponent","PowerCalendarMultipleDaysComponent","calendarAPI","components","Object","assign","_buildTask","context","generator","assert","normalizeCalendarValue","dayOrDays","console","log","days","_buildCollection","n","action","day","index","findIndex","selectedDate","isSame","slice","concat","normalizeMultipleActionValue","window","__powerCalendars","keys","length","setComponentTemplate","precompileTemplate","strictMode","scope","hash","element"],"mappings":"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"}